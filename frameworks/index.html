
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Вопросы и ответы по фреймворкам Python на сайте-методичке Python FAQ.">
      
      
      
        <link rel="canonical" href="https://u-cha.github.io/python-faq/frameworks/">
      
      
        <link rel="prev" href="../async/">
      
      
        <link rel="next" href="../testing/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Фреймворки - Python FAQ</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/open_in_new_tab.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Фреймворки - Python FAQ" >
      
        <meta  property="og:description"  content="Вопросы и ответы по фреймворкам Python на сайте-методичке Python FAQ." >
      
        <meta  property="og:image"  content="https://u-cha.github.io/python-faq/assets/images/social/frameworks.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://u-cha.github.io/python-faq/frameworks/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Фреймворки - Python FAQ" >
      
        <meta  name="twitter:description"  content="Вопросы и ответы по фреймворкам Python на сайте-методичке Python FAQ." >
      
        <meta  name="twitter:image"  content="https://u-cha.github.io/python-faq/assets/images/social/frameworks.png" >
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#orm-django-sqlalchemy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Python FAQ" class="md-header__button md-logo" aria-label="Python FAQ" data-md-component="logo">
      
  <img src="../img/pythonfaq.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python FAQ
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Фреймворки
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/u-cha/python-faq/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    python-faq gh
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Python FAQ" class="md-nav__button md-logo" aria-label="Python FAQ" data-md-component="logo">
      
  <img src="../img/pythonfaq.png" alt="logo">

    </a>
    Python FAQ
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/u-cha/python-faq/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    python-faq gh
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Core Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure_python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Устройство Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../collections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Коллекции
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Функции и декораторы
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Итераторы и генераторы
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context_managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Контекстные менеджеры
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../legb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Область видимости
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../oop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ООП Python
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Паттерны
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../async/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Многопоточность и асинхронность
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Фреймворки
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Фреймворки
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#orm-django-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое ORM? Примеры в Django и SQLAlchemy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает система аутентификации в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#middleware-django" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое middleware в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_1" class="md-nav__link">
    <span class="md-ellipsis">
      Какой паттерн в основе Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_2" class="md-nav__link">
    <span class="md-ellipsis">
      Какой путь проходит запрос в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastapi-vs-django" class="md-nav__link">
    <span class="md-ellipsis">
      FastAPI vs Django: когда что использовать?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django-rest-framework-drf" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Django REST Framework (DRF)?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apiview-viewset" class="md-nav__link">
    <span class="md-ellipsis">
      Разница между APIView и ViewSet?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelserializer-vs-serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают сериализаторы? (ModelSerializer vs Serializer)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryset-select_related-prefetch_related" class="md-nav__link">
    <span class="md-ellipsis">
      Как оптимизировать QuerySet? (select_related, prefetch_related)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manytomany" class="md-nav__link">
    <span class="md-ellipsis">
      Как реализована связь ManyToMany на уровне БД?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_3" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают миграции в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signals" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают сигналы (signals)? Когда их использовать?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqlalchemy-alembic" class="md-nav__link">
    <span class="md-ellipsis">
      Инструмент для миграций с SQLAlchemy — Alembic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relationship-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      Функция relationship() в SQLAlchemy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#many-to-many-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      Настройка связи Many-to-Many в SQLAlchemy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      Какие преимущества дает использование async в FastAPI?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependency-injection-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Injection в FastAPI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic" class="md-nav__link">
    <span class="md-ellipsis">
      Валидация данных (Pydantic модели)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Тестирование
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../message_queues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Очереди сообщений
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Инструменты
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Инструменты
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dependency_managers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Системы управления зависимостями
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Линтеры
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Базы данных
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../livecoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Лайвкодинг
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Изменения в проекте
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#orm-django-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое ORM? Примеры в Django и SQLAlchemy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает система аутентификации в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#middleware-django" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое middleware в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_1" class="md-nav__link">
    <span class="md-ellipsis">
      Какой паттерн в основе Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_2" class="md-nav__link">
    <span class="md-ellipsis">
      Какой путь проходит запрос в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastapi-vs-django" class="md-nav__link">
    <span class="md-ellipsis">
      FastAPI vs Django: когда что использовать?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django-rest-framework-drf" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Django REST Framework (DRF)?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apiview-viewset" class="md-nav__link">
    <span class="md-ellipsis">
      Разница между APIView и ViewSet?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modelserializer-vs-serializer" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают сериализаторы? (ModelSerializer vs Serializer)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryset-select_related-prefetch_related" class="md-nav__link">
    <span class="md-ellipsis">
      Как оптимизировать QuerySet? (select_related, prefetch_related)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manytomany" class="md-nav__link">
    <span class="md-ellipsis">
      Как реализована связь ManyToMany на уровне БД?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_3" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают миграции в Django?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signals" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают сигналы (signals)? Когда их использовать?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqlalchemy-alembic" class="md-nav__link">
    <span class="md-ellipsis">
      Инструмент для миграций с SQLAlchemy — Alembic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relationship-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      Функция relationship() в SQLAlchemy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#many-to-many-sqlalchemy" class="md-nav__link">
    <span class="md-ellipsis">
      Настройка связи Many-to-Many в SQLAlchemy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      Какие преимущества дает использование async в FastAPI?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependency-injection-fastapi" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Injection в FastAPI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic" class="md-nav__link">
    <span class="md-ellipsis">
      Валидация данных (Pydantic модели)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Фреймворки</h1>

<h2 id="orm-django-sqlalchemy"><strong>Что такое ORM? Примеры в Django и SQLAlchemy</strong></h2>
<p>ORM (Object-Relational Mapping) — это технология, которая позволяет взаимодействовать с базами данных, 
используя объекты, а не писать SQL-запросы напрямую. Вместо того чтобы писать SQL для выборки данных, 
ORM позволяет работать с объектами Python, которые соответствуют строкам в таблицах базы данных. 
Django и SQLAlchemy - два популярных инструмента Python, использующие ORM. </p>
<p><strong>ORM в Django:</strong>
Django ORM является частью фреймворка Django и позволяет работать с базой данных через объекты Python. 
Вот пример:</p>
<pre><code># Модель (определяет таблицу в базе данных)
class Book(models.Model):
    title = models.CharField(max_length=200)
    author = models.CharField(max_length=100)
    publication_date = models.DateField()

# Создание объекта
book = Book(title="Война и мир", author="Толстой", publication_date="1869-01-01")
book.save()

# Получение объекта
first_book = Book.objects.first()
print(first_book.title) # Вывод: Война и мир

# Фильтрация
books_by_tolstoy = Book.objects.filter(author="Толстой")
print(books_by_tolstoy.count()) # Вывод: количество книг Толстого

# Обновление
first_book.title = "Война и мир (полное издание)"
first_book.save()
</code></pre>
<p><strong>ORM в SQLAlchemy:</strong>
SQLAlchemy — это отдельная библиотека, которая может быть использована с Django или без него. 
Она предоставляет более гибкий и мощный подход к ORM, чем Django ORM, особенно для сложных запросов. 
Python</p>
<pre><code>from sqlalchemy import create_engine, Column, Integer, String, Date
from sqlalchemy.orm import sessionmaker
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import ForeignKey
from sqlalchemy.orm import relationship

# Создание движка базы данных
engine = create_engine('sqlite:///:memory:') # Пример использования in-memory базы данных
Base = declarative_base()

# Определение моделей
class Author(Base):
    __tablename__ = 'authors'
    id = Column(Integer, primary_key=True)
    name = Column(String)
    books = relationship("Book", back_populates="author") # Отношение один-ко-многим

    def __repr__(self):
        return f"&lt;Author(name='{self.name}')&gt;"

class Book(Base):
    __tablename__ = 'books'
    id = Column(Integer, primary_key=True)
    title = Column(String)
    publication_date = Column(Date)
    author_id = Column(Integer, ForeignKey('authors.id')) # Внешний ключ
    author = relationship("Author", back_populates="books")

    def __repr__(self):
        return f"&lt;Book(title='{self.title}', author='{self.author.name}')&gt;"

Base.metadata.create_all(engine)

# Создание сессии
Session = sessionmaker(bind=engine)
session = Session()

# Создание объектов
author1 = Author(name="Толстой")
book1 = Book(title="Война и мир", publication_date="1869-01-01", author=author1)
session.add_all([author1, book1])
session.commit()

# Получение данных
author = session.query(Author).filter_by(name="Толстой").first()
print(author.books) # Вывод: [&lt;Book(title='Война и мир', author='Толстой')&gt;]

# Фильтрация и сортировка
books = session.query(Book).filter(Book.publication_date &gt; "1860-01-01").order_by(Book.title).all()
print(books)
</code></pre>
<p><strong>Основные различия между Django ORM и SQLAlchemy:</strong></p>
<ul>
<li>Гибкость:
SQLAlchemy предоставляет более гибкий и мощный API, позволяя создавать сложные запросы, 
в то время как Django ORM удобен для более простых операций. </li>
<li>Отдельная библиотека:
SQLAlchemy - это отдельная библиотека, а Django ORM - часть фреймворка Django.</li>
</ul>
<h2 id="django">Как работает система аутентификации в Django?</h2>
<p>Система аутентификации Django обеспечивает проверку подлинности пользователей и 
управление доступом к ресурсам. Она включает в себя модель пользователя, middleware 
для обработки запросов и представлений для управления входом, выходом и другими операциями 
с учетными записями. Аутентификация в Django основана на сессиях и cookie, 
делая атрибут <code>request.user</code> доступным в представлениях, который содержит информацию о текущем пользователе. </p>
<p><strong>Основные компоненты системы аутентификации Django:</strong>
1. Модель пользователя (User Model):
Django предоставляет стандартную модель пользователя, которая включает поля для хранения 
информации о пользователе, такой как имя пользователя, пароль, email и т.д. 
Вы можете расширить эту модель или создать свою собственную. 
2. Middleware:
Middleware аутентификации обрабатывает входящие запросы, связывая пользователя 
с запросом на основе сессии. Он добавляет атрибут request.user к каждому запросу, 
который может быть использован в представлениях для определения текущего пользователя. 
3. Представления (Views):
Django предоставляет набор встроенных представлений для работы с аутентификацией:
<code>LoginView</code>: Для входа в систему.
<code>LogoutView</code>: Для выхода из системы.
<code>PasswordChangeView</code>: Для изменения пароля.
<code>PasswordResetView</code>: Для сброса пароля. </p>
<ol>
<li>Аутентификационные бэкенды:
Django позволяет использовать различные бэкенды аутентификации, такие как аутентификация 
по имени пользователя и паролю, аутентификация через социальные сети и т.д. 
Вы можете настроить используемые бэкенды в настройках проекта. </li>
<li>Разрешения:
Django предоставляет систему разрешений, которая позволяет управлять доступом 
к различным частям приложения на основе ролей и прав пользователей. 
Как работает аутентификация в Django:
Пользователь отправляет запрос на вход в систему.
Представление входа, например <code>LoginView</code>, получает данные пользователя (имя пользователя, пароль) и 
вызывает функцию <code>authenticate()</code>. </li>
</ol>
<p><code>authenticate()</code> перебирает настроенные бэкенды аутентификации и 
пытается аутентифицировать пользователя. Если один из бэкендов успешно аутентифицирует пользователя, 
возвращается объект пользователя. </p>
<p>Если аутентификация прошла успешно, Django создает сессию и сохраняет информацию о пользователе в cookie.
При каждом последующем запросе, middleware аутентификации использует сессию и cookie для определения 
текущего пользователя и делает его доступным в <code>request.user</code>. </p>
<p>В представлениях вы можете проверить, аутентифицирован ли пользователь, 
используя <code>request.user.is_authenticated</code>. </p>
<p>Вы также можете использовать систему разрешений для контроля доступа к определенным ресурсам или функциям. </p>
<p><strong>Пример использования</strong>:
    from django.shortcuts import render
    from django.contrib.auth.decorators import login_required
    @login_required
    def my_protected_view(request):
        # Эта функция доступна только для аутентифицированных пользователей
        return render(request, 'my_template.html', {'user': request.user})</p>
<p>В этом примере, <code>@login_required</code> декоратор гарантирует, что функция <code>my_protected_view</code> доступна 
только для аутентифицированных пользователей. Если пользователь не аутентифицирован, 
Django перенаправит его на страницу входа. </p>
<h2 id="middleware-django">Что такое middleware в Django?</h2>
<p>Middleware в Django — это промежуточный слой обработки запросов и ответов, представляющий собой набор функций/классов, которые обрабатывают запросы и ответы перед тем, как они достигнут view или после того, как view сгенерирует ответ.
Каждый middleware компонент отвечает за определенную функцию, такую как аутентификация пользователей, управление сессиями или защита от атак. </p>
<p>Как работает middleware:</p>
<ol>
<li>Обертывает запрос: middleware выступает как обертка вокруг других функций или middleware.</li>
<li>Обрабатывает запрос: перед тем как запрос достигнет целевого обработчика (например, вашей функции просмотра), middleware может модифицировать его или выполнить необходимую логику.</li>
<li>Обрабатывает ответ: после того как запрос был обработан, middleware может модифицировать ответ перед его отправкой клиенту.</li>
<li>Передает управление: middleware может либо передать управление следующему middleware (или просмотру), либо вернуть ответ самостоятельно, прервав дальнейшую обработку. </li>
</ol>
<p>Архитектура Middleware</p>
<pre><code>Запрос → MIDDLEWARE[0] → MIDDLEWARE[1] → ... → View
Ответ  ← MIDDLEWARE[1] ← MIDDLEWARE[0] ← ... ← View
</code></pre>
<p><strong>Стандартные middleware в Django</strong>
    # settings.py</p>
<pre><code>MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
]
</code></pre>
<p>Примеры использования middleware:</p>
<ul>
<li>SecurityMiddleware: Обеспечивает защиту от различных атак, например, от XSS или CSRF.</li>
<li>AuthenticationMiddleware: Связывает пользователя с запросом на основе сессии.</li>
<li>SessionMiddleware: Обеспечивает поддержку механизма сессий в Django.</li>
<li>CsrfViewMiddleware: Проверяет запросы на наличие CSRF-токена для предотвращения подделки запросов.</li>
</ul>
<p><strong>Создание кастомного middleware</strong></p>
<p>Пример: Логирование запросов</p>
<pre><code>import time

class TimingMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        start_time = time.time()

        response = self.get_response(request)

        duration = time.time() - start_time
        print(f"Запрос {request.path} выполнен за {duration:.2f} секунд")

        return response
</code></pre>
<p>В чем польза middleware:</p>
<ul>
<li>Гибкость: позволяет добавлять глобальную логику обработки без необходимости изменять код приложения.</li>
<li>Модульность: каждый компонент отвечает за свою функцию, что делает код более чистым и легко поддерживаемым. </li>
<li>Переиспользуемость: один и тот же middleware может использоваться в разных проектах для выполнения одинаковых задач</li>
<li>Middleware — это мощный механизм для сквозной функциональности в Django-приложениях.</li>
</ul>
<hr />
<h2 id="django_1">Какой паттерн в основе Django?</h2>
<p>В основе Django лежит архитектурный паттерн
Model-View-Template (MVT), который является модификацией более распространенного паттерна Model-View-Controller (MVC). </p>
<p>Обычно MVC описывают подобным образом:</p>
<ul>
<li>
<p>Model — доступ к хранилищу данных</p>
</li>
<li>
<p>View — это интерфейс, с которым взаимодействует пользователь </p>
</li>
<li>
<p>Controller — некий связывающий объект между model и view.</p>
</li>
</ul>
<p>MVT (Model-View-Template)</p>
<p><strong>Model</strong> (Модель)</p>
<ul>
<li>Отвечает за данные и бизнес-логику</li>
<li>Определяет структуру базы данных</li>
<li>Содержит валидацию и связи между данными</li>
</ul>
<p><strong>View</strong> (Представление)</p>
<ul>
<li>Обрабатывает запросы и возвращает ответы</li>
<li>Содержит логику приложения</li>
<li>Взаимодействует с моделями и шаблонами</li>
</ul>
<p><strong>Template</strong> (Шаблон)</p>
<ul>
<li>Отвечает за представление данных (UI)</li>
<li>HTML с Django Template Language</li>
<li>
<p>Отделяет логику от представления</p>
<p>Запрос → URLconf → View → Model → Template → Ответ
    ↓
(Controller - реализован в самом фреймворке)</p>
</li>
</ul>
<p><img alt="img.png" src="../img.png" /></p>
<hr />
<h2 id="django_2">Какой путь проходит запрос в Django?</h2>
<p>Когда к приложению приходит запрос, то URL dispatcher определяет, с каким ресурсом сопоставляется данный запрос и передает этот запрос выбранному ресурсу. Ресурс фактически представляет функцию или View, который получает запрос и определенным образом обрабатывает его. В процессе обработки View может обращаться к моделям и базе данных, получать из нее данные, или, наоборот, сохранять в нее данные. Результат обработки запроса отправляется обратно, и этот результат пользователь видит в своем браузере. Как правило, результат обработки запроса представляет сгенерированный html-код, для генерации которого применяются шаблоны (Template)</p>
<pre><code>HTTP Запрос → WSGI Сервер → Middleware → URLconf → View → Model 
→ Template → Middleware → HTTP Ответ
</code></pre>
<hr />
<h2 id="fastapi-vs-django">FastAPI vs Django: когда что использовать?</h2>
<p><strong>Когда выбирать Django:</strong></p>
<p><strong>✅ Для сложных веб-приложений с богатым функционалом</strong></p>
<pre><code class="language-python"># Админка из коробки
from django.contrib import admin
from .models import Product

@admin.register(Product)
class ProductAdmin(admin.ModelAdmin):
    list_display = ['name', 'price', 'created_at']
    # Готовая CRUD панель за 5 строк кода!
</code></pre>
<p><strong>✅ Проекты с требовательной бизнес-логикой</strong>
- Системы управления контентом (CMS)
- E-commerce платформы
- Социальные сети
- CRM/ERP системы</p>
<p><strong>✅ Когда нужна скорость разработки</strong></p>
<pre><code class="language-python"># Полная аутентификация за 5 минут
INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.sessions',
]

# В urls.py
path('accounts/', include('django.contrib.auth.urls'))
</code></pre>
<p><strong>✅ Проекты с классическим HTML-интерфейсом</strong>
- Серверный рендеринг (SSR)
- Формы с валидацией
- Пагинация, фильтрация
- Админ-панель для управления данными</p>
<p><strong>Когда выбирать FastAPI:</strong></p>
<p><strong>✅ API-ориентированные приложения</strong></p>
<pre><code class="language-python">from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()

class Item(BaseModel):
    name: str
    price: float

@app.post(&quot;/items/&quot;)
async def create_item(item: Item):
    # Автоматическая валидация + документация
    return {&quot;item&quot;: item}
</code></pre>
<p><strong>✅ Микросервисная архитектура</strong></p>
<pre><code class="language-python"># Каждый сервис независим
@app.get(&quot;/users/{user_id}&quot;)
async def read_user(user_id: int):
    return {&quot;user_id&quot;: user_id, &quot;name&quot;: &quot;John&quot;}

# Легко масштабируется горизонтально
</code></pre>
<p><strong>✅ Высокие требования к производительности</strong></p>
<pre><code class="language-python"># Асинхронные endpoint-ы
@app.get(&quot;/data/&quot;)
async def get_live_data():
    data = await fetch_from_database()  # Не блокирует другие запросы
    return data
</code></pre>
<p><strong>✅ Проекты с автоматической документацией</strong></p>
<pre><code class="language-python"># Документация доступна сразу:
# - /docs (Swagger UI)
# - /redoc (ReDoc)
# Генерируется автоматически!
</code></pre>
<p><strong>Сравнительная таблица</strong></p>
<table>
<thead>
<tr>
<th>Критерий</th>
<th>Django</th>
<th>FastAPI</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Производительность</strong></td>
<td>Хорошая</td>
<td><strong>Очень высокая</strong></td>
</tr>
<tr>
<td><strong>Скорость разработки</strong></td>
<td><strong>Очень высокая</strong></td>
<td>Высокая</td>
</tr>
<tr>
<td><strong>Асинхронность</strong></td>
<td>Ограниченная</td>
<td><strong>Полная поддержка</strong></td>
</tr>
<tr>
<td><strong>API документация</strong></td>
<td>Сторонние пакеты</td>
<td><strong>Автоматическая</strong></td>
</tr>
<tr>
<td><strong>Админ-панель</strong></td>
<td><strong>Встроенная</strong></td>
<td>Требует разработки</td>
</tr>
<tr>
<td><strong>ORM</strong></td>
<td><strong>Встроенный Django ORM</strong></td>
<td>Любая (SQLAlchemy, Tortoise)</td>
</tr>
<tr>
<td><strong>Кривая обучения</strong></td>
<td>Пологая</td>
<td>Крутая (требует знаний типов)</td>
</tr>
<tr>
<td><strong>Сообщество</strong></td>
<td><strong>Огромное</strong></td>
<td>Растущее</td>
</tr>
<tr>
<td><strong>Микросервисы</strong></td>
<td>Не идеально</td>
<td><strong>Идеально</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="django-rest-framework-drf">Что такое Django REST Framework (DRF)?</h2>
<p><strong>Django REST Framework (DRF)</strong> — это мощный инструмент для создания <strong>Web API</strong> поверх Django. Он предоставляет архитектурные компоненты для построения RESTful API.
DRF расширяет Django, добавляя специализированные компоненты для работы с API, сохраняя при этом все преимущества Django (ORM, аутентификацию, миграции).</p>
<p><strong>Ключевые компоненты</strong></p>
<ol>
<li><strong>Сериализаторы</strong></li>
<li><strong>Назначение</strong>: Преобразование данных между форматами (Python объекты ↔ JSON/XML)</li>
<li><strong>Аналогия</strong>: Как Django Forms, но для API</li>
<li>
<p><strong>Функции</strong>: Валидация данных, преобразование типов, контроль доступа к полям</p>
</li>
<li>
<p><strong>ViewSets и ViewClasses</strong></p>
</li>
<li><strong>ViewSets</strong>: Автоматическое создание CRUD операций для моделей</li>
<li><strong>APIView</strong>: Более гибкий контроль над отдельными endpoint'ами</li>
<li>
<p><strong>Generic Views</strong>: Готовые шаблоны для стандартных операций</p>
</li>
<li>
<p><strong>Роутеры</strong></p>
</li>
<li><strong>Назначение</strong>: Автоматическая генерация URL маршрутов для ViewSets</li>
<li>
<p><strong>Преимущество</strong>: Сокращает рутинный код маршрутизации</p>
</li>
<li>
<p><strong>Аутентификация и Права доступа</strong></p>
</li>
<li><strong>Аутентификация</strong>: Определение пользователя (Token, Session, JWT)</li>
<li><strong>Права доступа</strong>: Контроль действий пользователя (ReadOnly, IsAuthenticated, кастомные)</li>
</ol>
<p><strong>Архитектурные преимущества</strong></p>
<p><strong>Согласованность API</strong></p>
<ul>
<li>Единый подход ко всем endpoint'ам</li>
<li>Стандартизированные форматы ответов</li>
<li>Предсказуемая структура ошибок</li>
</ul>
<p><strong>Безопасность</strong></p>
<ul>
<li>Встроенные механизмы защиты от CSRF</li>
<li>Гибкая система прав доступа</li>
<li>Валидация данных на уровне сериализаторов</li>
</ul>
<p><strong>Производительность</strong></p>
<ul>
<li>Пагинация для больших наборов данных</li>
<li>Оптимизация запросов к БД</li>
<li>Кэширование на разных уровнях</li>
</ul>
<p><strong>Сценарии использования</strong></p>
<p><strong>✅ Идеально для:</strong>
- Backend для мобильных приложений
- API для SPA (React, Vue, Angular)
- Микросервисная архитектура
- Публичные API для сторонних разработчиков</p>
<p><strong>❌ Менее подходит для:</strong>
- Чисто серверрендерных приложений (только HTML)
- Простых сайтов-визиток
- Когда не нужен програмный интерфейс</p>
<p><strong>Главные преимущества перед "простым" Django</strong></p>
<ol>
<li><strong>Специализация</strong> — оптимизирован specifically для API</li>
<li><strong>Стандартизация</strong> — единый подход ко всем endpoint'ам  </li>
<li><strong>Документирование</strong> — автоматическая генерация документации</li>
<li><strong>Экосистема</strong> — богатый набор готовых компонентов</li>
<li><strong>Сообщество</strong> — активная разработка и поддержка</li>
</ol>
<p>DRF превращает Django из фреймворка для веб-сайтов в мощную платформу для создания API любого масштаба.</p>
<hr />
<h2 id="apiview-viewset">Разница между APIView и ViewSet?</h2>
<p><strong>APIView</strong> и <strong>ViewSet</strong> — это два разных уровня абстракции для создания API endpoint'ов в DRF.</p>
<p><strong>APIView</strong> — Базовый уровень (ручное управление)</p>
<p><strong>Концепция</strong>:</p>
<ul>
<li><strong>Один класс = Один endpoint</strong></li>
<li><strong>Явное определение</strong> HTTP-методов</li>
<li><strong>Полный контроль</strong> над логикой</li>
</ul>
<p><strong>Структура</strong>:</p>
<pre><code class="language-python">class UserAPI(APIView):
    def get(self, request): pass    # GET /users/
    def post(self, request): pass   # POST /users/

class UserDetailAPI(APIView):
    def get(self, request, pk): pass     # GET /users/1/
    def put(self, request, pk): pass     # PUT /users/1/
    def delete(self, request, pk): pass  # DELETE /users/1/
</code></pre>
<p><strong>Когда использовать</strong>:</p>
<ul>
<li><strong>Нестандартная логика</strong> обработки запросов</li>
<li><strong>Специфичные endpoint'ы</strong> (не CRUD)</li>
<li><strong>Тонкая настройка</strong> каждого метода</li>
<li><strong>Микросервисы</strong> с небольшой функциональностью</li>
</ul>
<p><strong>ViewSet</strong> — Высокий уровень (автоматизация)</p>
<p><strong>Концепция:</strong></p>
<ul>
<li><strong>Один класс = Все операции с ресурсом</strong></li>
<li><strong>Автоматическая</strong> маршрутизация</li>
<li><strong>Стандартные</strong> CRUD операции</li>
</ul>
<p><strong>Структура</strong>:</p>
<pre><code class="language-python">class UserViewSet(ViewSet):
    def list(self, request): pass      # GET /users/
    def create(self, request): pass    # POST /users/
    def retrieve(self, request, pk): pass   # GET /users/1/
    def update(self, request, pk): pass     # PUT /users/1/
    def destroy(self, request, pk): pass    # DELETE /users/1/
</code></pre>
<p><strong>Когда использовать</strong>:</p>
<ul>
<li><strong>Стандартные CRUD</strong> операции</li>
<li><strong>Быстрая разработка</strong> API</li>
<li><strong>Ресурс-ориентированная</strong> архитектура</li>
<li><strong>Админ-панели</strong> и бэкенды</li>
</ul>
<p><strong>ModelViewSet</strong> — Максимальная автоматизация</p>
<p><strong>Концепция</strong>:</p>
<ul>
<li><strong>Автоматические</strong> CRUD операции для модели</li>
<li><strong>Минимальный</strong> код</li>
</ul>
<pre><code class="language-python">class UserViewSet(ModelViewSet):
    queryset = User.objects.all()
    serializer_class = UserSerializer
    # Полный CRUD готов!
</code></pre>
<p><strong>Сравнительная таблица</strong></p>
<table>
<thead>
<tr>
<th>Критерий</th>
<th>APIView</th>
<th>ViewSet</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Уровень контроля</strong></td>
<td>✅ <strong>Полный</strong></td>
<td>⚠️ <strong>Ограниченный</strong></td>
</tr>
<tr>
<td><strong>Количество кода</strong></td>
<td>❌ <strong>Много</strong></td>
<td>✅ <strong>Мало</strong></td>
</tr>
<tr>
<td><strong>Стандартизация</strong></td>
<td>❌ <strong>Свободная</strong></td>
<td>✅ <strong>Единая</strong></td>
</tr>
<tr>
<td><strong>Маршрутизация</strong></td>
<td>❌ <strong>Ручная</strong></td>
<td>✅ <strong>Ручная</strong></td>
</tr>
<tr>
<td><strong>CRUD операции</strong></td>
<td>❌ <strong>Явные</strong></td>
<td>✅ <strong>Автоматические</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="modelserializer-vs-serializer">Как работают сериализаторы? (ModelSerializer vs Serializer)</h2>
<p>Сериализатор в DRF — это компонент, который преобразует сложные типы данных (например, экземпляры моделей Django QuerySet'ы) в простые форматы (JSON, XML и т.д.) для передачи по API, и наоборот — валидирует входящие данные и преобразует их обратно в сложные типы.</p>
<p><strong>Как они работают:</strong></p>
<ul>
<li><em>Направление данных</em>: Получают данные из представления (например, JSON из HTTP-запроса).</li>
<li><em>Валидация</em>: Проверяют корректность данных с помощью определенных полей и валидаторов.</li>
<li><em>Десериализация</em>: Если данные прошли валидацию, они преобразуются в объект Python (validated_data).</li>
<li><em>Сериализация</em>: Если требуется, эти данные из объекта Python сериализуются обратно в формат, понятный для клиента (например, JSON).</li>
<li><em>Сохранение</em>: Метод .save() сохраняет данные в базе данных с помощью встроенных методов create() или update()</li>
</ul>
<p>ModelSerializer и Serializer работают одинаково, но <strong>ModelSerializer</strong> автоматически создает поля на основе модели Django, 
тогда как <strong>Serializer</strong> используется для более гибкого контроля или когда связь с моделью не требуется. 
Оба сериализатора преобразуют данные (например, из запроса) в форматы, понятные для Django (или других фреймворков), и наоборот.</p>
<p><strong>Serializer</strong></p>
<ul>
<li><em>Назначение</em>: Когда вам нужна большая гибкость в определении полей или когда вы не работаете с моделью Django.</li>
<li><em>Пример</em>: Вы можете использовать его для создания JSON, который не соответствует напрямую модели, например, для агрегированных данных или данных из нескольких моделей. <pre><code>from rest_framework import serializers
from .models import Book

class BookSerializer(serializers.Serializer):
    id = serializers.IntegerField(read_only=True)
    title = serializers.CharField(max_length=200)
    author = serializers.CharField(max_length=100)
    published_date = serializers.DateField()
    is_available = serializers.BooleanField(default=True)
</code></pre>
</li>
</ul>
<p><strong>ModelSerializer</strong></p>
<ul>
<li><em>Назначение</em>: Быстрое создание сериализатора для модели Django.</li>
<li><em>Пример</em>: Вы просто указываете model и fields в классе, и DRF (Django REST Framework) автоматически генерирует поля и валидаторы на основе этой модели. Это избавляет от необходимости вручную описывать каждое поле<pre><code>  from rest_framework import serializers
  from .models import Book

  class BookModelSerializer(serializers.ModelSerializer):
      class Meta:
          model = Book
          fields = ['id', 'title', 'author', 'published_date', 'is_available']
          # fields = '__all__'  # Все поля модели
          read_only_fields = ['id']  # Поля только для чтения

      # Дополнительная валидация (опционально)
      def validate_title(self, value):
          if len(value) &lt; 2:
              raise serializers.ValidationError("Название слишком короткое")
          return value
</code></pre>
</li>
</ul>
<p><strong>Когда что использовать?</strong></p>
<p>✅  ModelSerializer когда:</p>
<ul>
<li>Работаете с моделями Django </li>
<li>Нужна быстрая разработка </li>
<li>Поля сериализатора соответствуют полям модели </li>
<li>Стандартное поведение create/update подходит</li>
</ul>
<p>✅  Базовый Serializer когда:</p>
<ul>
<li>Данные не привязаны к модели </li>
<li>Нужна сложная кастомная логика </li>
<li>Требуется нестандартная валидация </li>
<li>Источник данных — несколько моделей или внешние API</li>
</ul>
<p>Статья на хабре - <a href="https://habr.com/ru/companies/yandex_praktikum/articles/598349/">Django Rest Framework для начинающих: как работает ModelSerializer</a>
https://habr.com/ru/companies/yandex_praktikum/articles/598349/</p>
<hr />
<h2 id="queryset-select_related-prefetch_related">Как оптимизировать QuerySet? (select_related, prefetch_related)</h2>
<p><strong>QuerySet</strong> — это фундаментальное понятие в Django, которое представляет собой коллекцию объектов из базы данных.</p>
<p>QuerySet — это "ленивый" (lazy) объект, который:</p>
<ul>
<li>Описывает SQL запрос к базе данных </li>
<li>Не выполняется до момента реального использования данных </li>
<li>Позволяет строить сложные запросы цепочкой методов</li>
</ul>
<p>N+1 проблема возникает когда:</p>
<ul>
<li>Сначала выполняется 1 запрос для получения основной коллекции объектов</li>
<li>Затем для каждого объекта выполняется дополнительный запрос для получения связанных данных<pre><code>class Book(models.Model):
    title = models.CharField(max_length=200)
    authors = models.ManyToManyField(Author)  # ManyToMany

class Author(models.Model):
    name = models.CharField(max_length=100)

    books = Book.objects.all()
    for book in books:
        print(book.title)           # 1 запрос
        print(book.author.name)     # N запросов (по одному на каждую книгу)
</code></pre>
</li>
</ul>
<p><strong>Select_related</strong> используется для:</p>
<ul>
<li>Для ForeignKey и OneToOneField </li>
<li>Выполняет JOIN на уровне SQL</li>
<li>Загружает связанные объекты в одном запросе</li>
</ul>
<p><em>Синтаксис</em>:</p>
<pre><code>queryset.select_related('related_field')

books = Book.objects.select_related('author').all()
</code></pre>
<p><strong>Prefetch_related</strong> используется для:</p>
<ul>
<li>Для ManyToManyField и reverse ForeignKey</li>
<li>Выполняет отдельный запрос для каждого отношения</li>
<li>Оптимизирует загрузку с помощью Python</li>
</ul>
<p><em>Синтаксис</em>:</p>
<pre><code>queryset.prefetch_related('related_field')

authors = Author.objects.prefetch_related('book_set').all()
</code></pre>
<p>Статьи на хабре - <a href="https://habr.com/ru/articles/752574/">Как работают select_related и prefetch_related в Django </a>https://habr.com/ru/articles/752574/</p>
<p><a href="https://habr.com/ru/companies/otus/articles/875384/">Django против N+1 запросов: оптимизация с помощью select_related и prefetch_related</a> https://habr.com/ru/companies/otus/articles/875384/</p>
<hr />
<h2 id="manytomany">Как реализована связь ManyToMany на уровне БД?</h2>
<p>Связь ManyToMany в реляционных базах данных реализуется через промежуточную таблицу (join table).</p>
<p>Модели Django:</p>
<pre><code>class Student(models.Model):
    name = models.CharField(max_length=100)

class Course(models.Model):
    title = models.CharField(max_length=100)
    students = models.ManyToManyField(Student)  # Связь ManyToMany
</code></pre>
<p>Соответствующая структура БД:</p>
<pre><code>-- Таблица студентов
CREATE TABLE app_student (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

-- Таблица курсов  
CREATE TABLE app_course (
    id SERIAL PRIMARY KEY,
    title VARCHAR(100) NOT NULL
);

-- ПРОМЕЖУТОЧНАЯ таблица (автоматически создается Django)
CREATE TABLE app_course_students (
    id SERIAL PRIMARY KEY,
    course_id INTEGER REFERENCES app_course(id) ON DELETE CASCADE,
    student_id INTEGER REFERENCES app_student(id) ON DELETE CASCADE,
    UNIQUE(course_id, student_id)  -- Уникальная пара
);
</code></pre>
<p>Реализация в Django - атоматическая промежуточная таблица (поле ManyToManyField)</p>
<pre><code>class Course(models.Model):
    title = models.CharField(max_length=100)
    students = models.ManyToManyField(Student)
    # Django автоматически создаст app_course_students

# Создание объектов
math = Course.objects.create(title="Математика")
physics = Course.objects.create(title="Физика")

ivan = Student.objects.create(name="Иван")
maria = Student.objects.create(name="Мария")

# ДОБАВЛЕНИЕ связей
math.students.add(ivan)           # Один объект
math.students.add(ivan, maria)    # Несколько объектов
math.students.add(*[ivan, maria]) # Список объектов

# СОЗДАНИЕ через промежуточную таблицу (если through)
enrollment = Enrollment.objects.create(
    student=ivan, 
    course=math, 
    grade='A'
)

# УДАЛЕНИЕ связей
math.students.remove(ivan)        # Удалить одного
math.students.clear()             # Удалить всех

# ПРОВЕРКА связей
if ivan in math.students.all():
    print("Иван записан на математику")

# КОЛИЧЕСТВО
student_count = math.students.count()
</code></pre>
<p>QuerySet операции:</p>
<pre><code># Все студенты курса
students = math.students.all()

# Все курсы студента  
courses = ivan.course_set.all()

# Фильтрация через связь
math_courses = Course.objects.filter(students__name='Иван')
smart_students = Student.objects.filter(course__title='Математика')
</code></pre>
<hr />
<h2 id="django_3">Как работают миграции в Django?</h2>
<p>Миграции в Django — это система контроля версий для структуры базы данных. Они позволяют изменять схему БД без потери данных и синхронизировать изменения между разными окружениями.
Как работают миграции?</p>
<p>Основной принцип:
- Миграции описывают изменения в моделях Django 
- Django генерирует SQL на основе этих описаний 
- Применяет SQL к БД в правильном порядке</p>
<p><strong>Процесс работы с миграциями Django</strong></p>
<p><strong>Создание миграций</strong></p>
<pre><code class="language-bash"># После изменения models.py
python manage.py makemigrations
</code></pre>
<ul>
<li>Django анализирует изменения моделей</li>
<li>Генерирует файлы миграций в папке <code>migrations/</code></li>
<li><strong>Результат:</strong> файлы типа <code>0002_add_field.py</code></li>
</ul>
<p><strong>Проверка (опционально)</strong></p>
<pre><code class="language-bash"># Посмотреть SQL который выполнится
python manage.py sqlmigrate app_name 0002

# Посмотреть план применения
python manage.py showmigrations
</code></pre>
<p><strong>Применение миграций</strong></p>
<pre><code class="language-bash"># Применить все миграции
python manage.py migrate

# Применить для конкретного приложения
python manage.py migrate app_name
</code></pre>
<ul>
<li>Django выполняет SQL команды в БД</li>
<li>Записывает факт применения в таблицу <code>django_migrations</code></li>
</ul>
<p><strong>Откат при необходимости</strong></p>
<pre><code class="language-bash"># Откатить до конкретной миграции
python manage.py migrate app_name 0001

# Полный откат приложения
python manage.py migrate app_name zero
</code></pre>
<p><strong>Основные команды</strong>:</p>
<table>
<thead>
<tr>
<th>Команда</th>
<th>Назначение</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>makemigrations</code></td>
<td>Создать миграции после изменения моделей</td>
</tr>
<tr>
<td><code>migrate</code></td>
<td>Применить миграции к БД</td>
</tr>
<tr>
<td><code>showmigrations</code></td>
<td>Показать статус миграций</td>
</tr>
<tr>
<td><code>sqlmigrate</code></td>
<td>Показать SQL для миграции</td>
</tr>
</tbody>
</table>
<p><strong>Важно</strong>:</p>
<ul>
<li><strong>Миграции создаются</strong> после изменения <code>models.py</code></li>
<li><strong>Миграции применяются</strong> на каждой копии проекта (dev/stage/prod)</li>
<li><strong>Порядок важен</strong> - миграции применяются последовательно</li>
<li><strong>Файлы миграций</strong> нужно коммитить в Git</li>
</ul>
<p><strong>Процесс:</strong> Изменил модели → <code>makemigrations</code> → <code>migrate</code> → Повторить на всех серверах</p>
<hr />
<h2 id="signals">Как работают сигналы (signals)? Когда их использовать?</h2>
<p>Сигналы работают как механизм уведомления о произошедших событиях или изменениях.
Они используются для разделения логики, создания модульности и реализации многоуровневой обработки событий
Они реализуют паттерн "наблюдатель", когда одни части кода могут "подписываться" на события из других частей.</p>
<p><strong>Основные типы сигналов</strong></p>
<p><strong>Модельные сигналы (самые используемые)</strong>:</p>
<ul>
<li><code>pre_save</code> - вызывается перед сохранением объекта</li>
<li><code>post_save</code> - вызывается после сохранения объекта  </li>
<li><code>pre_delete</code> - перед удалением объекта</li>
<li><code>post_delete</code> - после удаления объекта</li>
<li><code>m2m_changed</code> - при изменении ManyToMany связи</li>
</ul>
<p><strong>Как работают сигналы?</strong></p>
<p>Сигналы состоят из двух частей:</p>
<ol>
<li><strong>Отправитель</strong> (sender) - тот, кто генерирует событие</li>
<li><strong>Получатель</strong> (receiver) - функция, которая реагирует на событие</li>
</ol>
<p>Базовый пример:</p>
<pre><code class="language-python">from django.db.models.signals import post_save
from django.dispatch import receiver
from django.contrib.auth.models import User

# Получатель - функция с декоратором @receiver
@receiver(post_save, sender=User)
def create_user_profile(sender, instance, created, **kwargs):
    &quot;&quot;&quot;
    Автоматически создаем профиль при создании пользователя
    &quot;&quot;&quot;
    if created:  # created=True только при создании нового объекта
        Profile.objects.create(user=instance)
</code></pre>
<p><strong>Практические примеры использования</strong></p>
<ul>
<li>Автоматическое создание связанных объектов</li>
</ul>
<pre><code class="language-python">@receiver(post_save, sender=User)
def setup_new_user(sender, instance, created, **kwargs):
    if created:
        # Создаем профиль, настройки и корзину для нового пользователя
        Profile.objects.create(user=instance)
        UserSettings.objects.create(user=instance)
        Cart.objects.create(user=instance)
</code></pre>
<ul>
<li>Кеширование данных</li>
</ul>
<pre><code class="language-python">@receiver(post_save, sender=Product)
@receiver(post_delete, sender=Product)
def clear_product_cache(sender, **kwargs):
    &quot;&quot;&quot;Очищаем кеш при изменении продуктов&quot;&quot;&quot;
    cache.delete('featured_products')
    cache.delete('product_list')
</code></pre>
<ul>
<li>Уведомления</li>
</ul>
<pre><code class="language-python">@receiver(post_save, sender=Order)
def notify_about_order(sender, instance, created, **kwargs):
    if created:
        # Отправляем email менеджеру о новом заказе
        send_mail(
            'Новый заказ',
            f'Поступил новый заказ #{instance.id}',
            'noreply@shop.com',
            ['manager@shop.com']
        )
</code></pre>
<p><strong>Когда стоит использовать сигналы?</strong></p>
<ul>
<li>
<p><strong>Автоматические действия</strong> - когда нужно выполнить действие автоматически в ответ на событие:</p>
<ul>
<li>Создание связанных записей</li>
<li>Отправка уведомлений</li>
<li>Очистка кеша</li>
<li>Синхронизация данных</li>
</ul>
</li>
<li>
<p><strong>Сквозная функциональность</strong> - логирование, аудит, безопасность</p>
</li>
<li>
<p><strong>Интеграции</strong> - когда разные части приложения слабо связаны</p>
</li>
</ul>
<p><strong>Проблемы и ограничения сигналов</strong></p>
<ol>
<li><strong>Сложность отладки</strong> - не очевидно, какие обработчики выполняются</li>
<li><strong>Циклические зависимости</strong> - могут возникнуть бесконечные циклы</li>
<li><strong>Производительность</strong> - много сигналов могут замедлить приложение</li>
<li><strong>Тестирование</strong> - сложнее тестировать код с сигналами</li>
</ol>
<p>Статья на хабре - <a href="https://habr.com/ru/companies/otus/articles/873118/">Signals в Django</a> https://habr.com/ru/companies/otus/articles/873118/ </p>
<hr />
<h2 id="sqlalchemy-alembic">Инструмент для миграций с SQLAlchemy — Alembic</h2>
<p><strong>Почему Alembic?</strong></p>
<ol>
<li><strong>Официальная интеграция</strong> — создан тем же автором, что и SQLAlchemy (Майклом Байером)</li>
<li><strong>Глубокая совместимость</strong> — хорошо работает со всеми возможностями SQLAlchemy</li>
<li><strong>Автогенерация миграций</strong> — умеет создавать миграции, сравнивая модели и существующую БД</li>
</ol>
<p><strong>Ключевые возможности:</strong></p>
<pre><code class="language-bash"># Основные команды
alembic init migrations          # Инициализация
alembic revision --autogenerate  # Автогенерация миграции
alembic upgrade head             # Применить миграции

alembic downgrade -1             # Откатить последнюю миграцию
alembic downgrade -2             # Откатить на N миграций назад
alembic downgrade ae1027a6acf    # Откатить до конкретной ревизии
alembic downgrade base           # Полный откат всех миграций (до пустой БД
alembic downgrade +2             # Откатить до определённой метки
</code></pre>
<p><strong>Преимущества:</strong></p>
<p>✅ <strong>Автогенерация миграций</strong> — анализирует разницу между моделями и схемой БД<br />
✅ <strong>Гибкие шаблоны миграций</strong> — возможность кастомизировать сгенерированный код<br />
✅ <strong>Поддержка транзакций</strong> — выполнение миграций внутри транзакций для безопасности<br />
✅ <strong>Ветвление миграций</strong> — работа со сложными сценариями обновлений<br />
✅ <strong>Интеграция с CI/CD</strong> — легко встраивается в процессы развёртывания  </p>
<p><strong>Пример использования:</strong></p>
<pre><code class="language-python"># Модель SQLAlchemy
from sqlalchemy import Column, Integer, String
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class User(Base):
    __tablename__ = 'users'
    id = Column(Integer, primary_key=True)
    name = Column(String(50), nullable=False)
    email = Column(String(100), unique=True)  # Добавляем новое поле
</code></pre>
<pre><code class="language-bash"># Alembic автоматически сгенерирует миграцию:
# alembic revision --autogenerate -m &quot;Add email field to users&quot;
</code></pre>
<p><strong>Альтернативы:</strong></p>
<ul>
<li><strong>Django Migrations</strong> — только для Django, не для чистого SQLAlchemy</li>
<li><strong>Flask-Migrate</strong> — обёртка над Alembic для Flask</li>
<li><strong>Manual SQL scripts</strong> — риск ошибок, нет контроля версий</li>
<li><strong>SQLAlchemy-migrate</strong> — устарел, не рекомендуется</li>
</ul>
<p><strong>Best Practices с Alembic:</strong></p>
<ol>
<li><strong>Всегда проверяйте сгенерированные миграции</strong> — автогенерация не идеальна</li>
<li><strong>Используйте среду выполнения для сложных операций</strong> — данные, зависящие от БД</li>
<li><strong>Храните миграции в VCS (Git)</strong> — для истории изменений схемы</li>
<li><strong>Тестируйте миграции на staging</strong> — перед применением в production</li>
</ol>
<hr />
<h2 id="relationship-sqlalchemy"><strong>Функция <code>relationship()</code> в SQLAlchemy</strong></h2>
<p>Функция <strong><code>relationship()</code></strong> из модуля <code>sqlalchemy.orm</code> создаёт связи между таблицами на уровне ORM, позволяя автоматически "подтягивать" связанные данные при работе с объектами Python.
<code>relationship()</code> делает связанные таблицы доступными как естественная часть объектной модели, автоматически управляя SQL-запросами и позволяя работать с реляционными данными как с обычными атрибутами Python-объектов.</p>
<p><strong>Ключевые особенности:</strong></p>
<ol>
<li><strong>Работа в паре с <code>ForeignKey</code></strong>  </li>
<li><code>ForeignKey</code> определяет связь на уровне базы данных</li>
<li>
<p><code>relationship()</code> управляет доступом к связанным объектам на уровне Python</p>
</li>
<li>
<p><strong>Автоматическая загрузка данных</strong><br />
   При обращении к атрибуту, определённому через <code>relationship()</code>, SQLAlchemy автоматически выполняет SQL-запрос для получения связанных данных:</p>
</li>
</ol>
<pre><code class="language-python">   user = session.query(User).first()
   # Автоматически выполняет: SELECT * FROM posts WHERE user_id = ?
   user_posts = user.posts  
</code></pre>
<ol>
<li><strong>Стратегии загрузки данных (параметр <code>lazy</code>)</strong>:</li>
<li><strong><code>select</code></strong> (по умолчанию) — данные загружаются отдельным запросом при обращении</li>
<li><strong><code>joined</code></strong> — данные загружаются одним JOIN-запросом сразу</li>
<li>
<p><strong><code>dynamic</code></strong> — возвращает объект Query для дополнительной фильтрации</p>
</li>
<li>
<p><strong>Основные параметры</strong>:</p>
</li>
<li><strong><code>backref</code></strong> / <strong><code>back_populates</code></strong> — создают обратную ссылку</li>
<li><strong><code>lazy</code></strong> — управляет стратегией загрузки данных</li>
<li><strong><code>uselist</code></strong> — определяет тип связи (один-ко-многим или один-к-одному)</li>
<li><strong><code>cascade</code></strong> — задаёт каскадные операции</li>
</ol>
<p><strong>Практический пример</strong>:</p>
<pre><code class="language-python">from sqlalchemy.orm import relationship

class User(Base):
    id = Column(Integer, primary_key=True)
    posts = relationship(&quot;Post&quot;, backref=&quot;author&quot;)  # Создаёт связь

class Post(Base):
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey('users.id'))  # Внешний ключ
</code></pre>
<p><strong>Как это используется</strong>:</p>
<pre><code class="language-python"># Получаем пользователя
user = session.get(User, 1)

# Автоматически загружаем все его посты (выполняется SQL-запрос)
for post in user.posts:  
    print(post.title)

# Обратная связь также работает
post = session.get(Post, 5)
author = post.author  # Автоматически загружает объект User
</code></pre>
<hr />
<h2 id="many-to-many-sqlalchemy"><strong>Настройка связи Many-to-Many в SQLAlchemy</strong></h2>
<p><strong>Основной принцип</strong></p>
<p>Связь "многие-ко-многим" требует промежуточной таблицы, которая соединяет две основные таблицы. SQLAlchemy предлагает два подхода для её реализации.</p>
<p><strong>Способ 1: Простая промежуточная таблица (рекомендуется)</strong></p>
<p>Используется, когда в связи не нужно хранить дополнительные данные:</p>
<ol>
<li>Создаётся таблица-ассоциация только с двумя внешними ключами</li>
<li>Добавляется параметр <code>secondary</code> в <code>relationship()</code>, указывающий на эту таблицу</li>
<li>Настраиваются обратные ссылки через <code>back_populates</code> или <code>backref</code></li>
</ol>
<p>Преимущества: минимальный код, автоматическое управление связями.</p>
<p><strong>Способ 2: Модель ассоциации (ассоциативный объект)</strong></p>
<p>Используется, когда нужно хранить <strong>дополнительные атрибуты</strong> в связи (дату создания, статус и т.д.):</p>
<ol>
<li>Создаётся полноценная модель для промежуточной таблицы</li>
<li>Добавляются нужные поля помимо внешних ключей</li>
<li>Настраиваются две связи один-ко-многим от каждой основной таблицы к ассоциативной</li>
</ol>
<p>Преимущества: гибкость, возможность добавлять бизнес-логику в связь.</p>
<p><strong>Параметры для <code>relationship()</code> в Many-to-Many:</strong></p>
<ul>
<li><strong><code>secondary</code></strong> — указатель на промежуточную таблицу</li>
<li><strong><code>backref</code> / <code>back_populates</code></strong> — настройка обратного доступа</li>
<li><strong><code>lazy</code></strong> — стратегия загрузки ('select', 'joined', 'dynamic')</li>
<li><strong><code>cascade</code></strong> — правила каскадного удаления/обновления</li>
</ul>
<p><strong>Работа со связью на практике:</strong></p>
<ul>
<li><strong>Добавление:</strong> <code>user.roles.append(role)</code></li>
<li><strong>Удаление:</strong> <code>user.roles.remove(role)</code></li>
<li><strong>Запросы:</strong> фильтрация по связанным объектам работает автоматически</li>
<li><strong>Загрузка:</strong> можно настроить жадную загрузку через <code>lazy='joined'</code></li>
</ul>
<p><strong>Рекомендации:</strong></p>
<ul>
<li>Для простых случаев используйте первый способ с параметром <code>secondary</code></li>
<li>Для сложных связей с данными используйте ассоциативную модель</li>
<li>Всегда настраивайте обратные ссылки для удобства доступа</li>
<li>Тестируйте стратегии загрузки для оптимизации запросов</li>
</ul>
<hr />
<h2 id="async-fastapi">Какие преимущества дает использование async в FastAPI?</h2>
<p><strong>1. Высокая производительность и масштабируемость</strong></p>
<p>При использовании асинхронного программирования FastAPI может обрабатывать тысячи одновременных подключений на одном процессе. Это достигается за счет неблокирующей природы async - когда один запрос ожидает ответа от базы данных или внешнего API, event loop может переключиться на обработку других запросов. В результате сервер не простаивает в ожидании I/O операций, что кардинально увеличивает пропускную способность приложения.</p>
<p><strong>2. Эффективное управление ресурсами</strong></p>
<p>Традиционные синхронные приложения требуют создания отдельных потоков или процессов для каждого одновременного подключения, что потребляет значительные ресурсы памяти и процессора. Асинхронный подход позволяет обслуживать множество запросов в рамках одного потока, drastically снижая нагрузку на систему и позволяя серверу работать с ограниченными ресурсами более эффективно.</p>
<p><strong>3. Улучшенная обработка I/O операций</strong></p>
<p>Подавляющее большинство веб-приложений являются I/O-bound, то есть их производительность ограничена операциями ввода-вывода: запросами к базам данных, вызовами внешних API, чтением файлов. Async операции идеально подходят для таких сценариев, поскольку позволяют приостанавливать выполнение функции на время ожидания ответа от внешних систем, освобождая ресурсы для обработки других запросов.</p>
<p><strong>4. Естественная поддержка современных протоколов</strong></p>
<p>FastAPI с async отлично работает с современными веб-протоколами, такими как WebSockets для реального времени и HTTP/2 для улучшенной производительности. Асинхронная модель идеально подходит для long-lived соединений, где требуется постоянная двусторонняя связь между клиентом и сервером без блокировки других операций.</p>
<p><strong>5. Упрощенный код для сложных операций</strong></p>
<p>Хотя асинхронное программирование требует определенного обучения, оно упрощает написание кода для сложных сценариев, таких как параллельное выполнение нескольких внешних запросов или обработка множества событий одновременно. Конструкции типа <code>asyncio.gather()</code> позволяют легко организовывать параллельное выполнение независимых операций.</p>
<p><strong>6. Совместимость с современной экосистемой</strong></p>
<p>Большинство современных библиотек для Python, особенно для работы с базами данных, HTTP-клиентов и кэширования, теперь предоставляют асинхронные интерфейсы. Это позволяет создавать полностью асинхронные приложения, где все компоненты работают в единой неблокирующей парадигме, максимизируя производительность.</p>
<p><strong>7. Будуще-ориентированность</strong></p>
<p>Асинхронное программирование становится стандартом для высокопроизводительных веб-приложений. Инвестируя в изучение и использование async сейчас, разработчики готовятся к будущим требованиям и технологиям, обеспечивая долгосрочную жизнеспособность своих приложений.</p>
<p>Важно отметить, что async не является панацеей и наиболее эффективен именно для I/O-bound приложений. Для CPU-intensive задач, где ограничением является процессорное время, традиционные многопоточные или многопроцессные подходы могут оказаться более подходящими. Однако для типичных веб-API, которые в основном работают с базами данных и внешними сервисами, переход на async обеспечивает существенный прирост производительности при меньшем потреблении ресурсов.</p>
<hr />
<h2 id="dependency-injection-fastapi">Dependency Injection в FastAPI</h2>
<p>Dependency Injection (DI) — это архитектурный паттерн, при котором компоненты получают свои зависимости из внешних источников, вместо того чтобы создавать их внутри себя. В FastAPI это встроенная система, которая автоматически управляет зависимостями и внедряет их там, где они нужны.
Dependency Injection в FastAPI — это мощный инструмент для создания чистого, модульного и тестируемого кода. Он помогает разделять ответственность и упрощает поддержку приложения.</p>
<p>FastAPI использует механизм Depends() для объявления зависимостей. Когда запрос поступает на endpoint, FastAPI автоматически:</p>
<ul>
<li>Определяет, какие зависимости требуются </li>
<li>Выполняет эти зависимости </li>
<li>Внедряет результаты в endpoint функцию</li>
</ul>
<p>Базовый пример</p>
<pre><code>from fastapi import FastAPI, Depends

app = FastAPI()

def get_database():
    return "Database Connection"

@app.get("/items/")
async def read_items(db: str = Depends(get_database)):
    return {"data": db}
</code></pre>
<p>В этом примере get_database — это зависимость, которая автоматически выполняется при каждом запросе к /items/, и ее результат передается в параметр db.</p>
<p><strong>Практическое применение</strong></p>
<ol>
<li>
<p><strong>Аутентификация</strong></p>
<p>def get_current_user(token: str = Header(...)):
    user = decode_jwt(token)
    return user</p>
<p>@app.get("/profile")
async def profile(user: dict = Depends(get_current_user)):
    return user</p>
</li>
<li>
<p><strong>Валидация данных</strong></p>
<p>def validate_ids(ids: str = Query(...)):
    return [int(id) for id in ids.split(",")]</p>
<p>@app.get("/items/")
async def get_items(ids: list = Depends(validate_ids)):
    return {"ids": ids}</p>
</li>
</ol>
<p><strong>🎯 Преимущества Dependency Injection</strong></p>
<p><strong>🧪 Тестируемость</strong>
Mock-зависимости для изолированного тестирования</p>
<p><strong>🔄 Переиспользование</strong>
Одна зависимость — множество endpoints</p>
<p><strong>🏗 Архитектура</strong>
Четкое разделение ответственности</p>
<p><strong>⚡ Автоматизация</strong>
FastAPI сам управляет зависимостями</p>
<p><strong>🔧 Гибкость</strong>
Легко менять реализации для разных окружений</p>
<p><strong>🛠 Поддерживаемость</strong>
Изменения в одном месте применяются везде</p>
<p>Статьи на хабре <a href="https://habr.com/ru/articles/867040/">FastAPI и Dependency Injection: правда или вымысел?</a></p>
<p><a href="https://habr.com/ru/articles/528634/">FastAPI + Dependency Injector / Хабр</a></p>
<hr />
<h2 id="pydantic">Валидация данных (Pydantic модели)</h2>
<p>Валидация данных с помощью Pydantic-моделей — это
процесс проверки данных на соответствие ожидаемым типам и форматам с использованием классов, основанных на подсказках типов Python. Pydantic автоматически проверяет входные данные, выполняет их преобразование при необходимости, и выдает подробные сообщения об ошибках при несоответствии. Это упрощает разработку, обеспечивает корректность данных и упрощает документацию API. </p>
<p><strong>Как это работает</strong></p>
<ul>
<li><em>Определение моделей</em>: Вы создаете классы, наследуемые от BaseModel (или с помощью датаклассов) и указываете типы для каждого поля, например int, str, datetime.</li>
<li><em>Автоматическая валидация</em>: При создании объекта модели Pydantic проверяет, соответствуют ли переданные значения указанным типам. Если вы передаете, например, строку вместо целого числа, возникнет ошибка.</li>
<li><em>Преобразование данных</em>: Pydantic может автоматически преобразовывать данные. Если вы ожидаете дату, а получаете строку, он попытается преобразовать строку в объект datetime.</li>
<li><em>Подробные сообщения об ошибках</em>: В случае ошибки Pydantic предоставляет подробное сообщение, указывающее, что ожидалось, что было получено и где искать проблему.</li>
<li><em>Сериализация/десериализация</em>: Модели Pydantic позволяют легко преобразовывать данные между форматом модели и форматами, такими как JSON. </li>
</ul>
<pre><code class="language-python">from pydantic import BaseModel, EmailStr, Field
from typing import List, Optional

class UserCreate(BaseModel):
    email: EmailStr                    # Автоматическая валидация email
    age: int = Field(gt=0, le=120)     # Ограничения: 0 &lt; age &lt;= 120
    name: str = Field(min_length=2, max_length=50)
    tags: List[str] = []               # Список с значением по умолчанию
</code></pre>
<p><strong>✅ Типы валидации</strong></p>
<p><strong>Встроенные валидаторы</strong></p>
<pre><code class="language-python">from pydantic import validator

class UserCreate(BaseModel):
    email: EmailStr

    @validator('name')
    def name_must_contain_space(cls, v):
        if ' ' not in v:
            raise ValueError('Must contain space')
        return v.title()  # Автоматическое преобразование
</code></pre>
<p><strong>Кастомные ограничения</strong></p>
<pre><code class="language-python">class Product(BaseModel):
    price: float = Field(gt=0)           # Только положительные значения
    quantity: int = Field(ge=0)          # Неотрицательное число
    category: str = Field(regex='^[A-Z][a-z]+$')  # Регулярные выражения
</code></pre>
<p><strong>🚀 Использование в эндпоинтах</strong></p>
<pre><code class="language-python">@app.post(&quot;/users/&quot;)
async def create_user(user: UserCreate):  # ← Автовалидация
    # Данные уже проверены и приведены к правильным типам
    return {&quot;message&quot;: &quot;User created&quot;, &quot;user&quot;: user.dict()}

@app.put(&quot;/items/{item_id}&quot;)
async def update_item(
    item_id: int,
    item: UserCreate,                    # Тело запроса
    user: User = Depends(get_current_user)  # Зависимости + валидация
):
    return {&quot;item_id&quot;: item_id, **item.dict()}
</code></pre>
<p><strong>⚡ Преимущества</strong></p>
<p><strong>Автоматическая документация</strong></p>
<ul>
<li>Swagger UIсразу показывает схемы данных</li>
<li>Примеры запросов генерируются автоматически</li>
<li>Ошибки валидации - детальные сообщения</li>
</ul>
<p><strong>Производительность</strong></p>
<ul>
<li>Валидация при парсинге - один проход для всех проверок</li>
<li>JSON → Python объекты - быстрое преобразование</li>
<li>Подсказки типов - лучше автодополнение в IDE</li>
</ul>
<p><strong>Безопасность</strong></p>
<ul>
<li>Защита от мусорных данных - только объявленные поля</li>
<li>Приведение типов - "123" → 123 (если ожидается int)</li>
<li>Чистые данные - гарантированная структура</li>
</ul>
<p>Статья на хабре <a href="https://habr.com/ru/companies/amvera/articles/851642/">Pydantic 2: Полное руководство для Python-разработчиков — от основ до продвинутых техник</a> https://habr.com/ru/companies/amvera/articles/851642/</p>
<hr />







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>